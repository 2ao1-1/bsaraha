name: ðŸ” Debug Deployment

on:
  workflow_dispatch: # Manual trigger only

jobs:
  debug-server:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ•µï¸ Debug Server Status
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          password: ${{ secrets.SERVER_PASSWORD }}
          script: |
            echo "ðŸ–¥ï¸ Server Information:"
            echo "ðŸ“… Date: $(date)"
            echo "ðŸ‘¤ User: $(whoami)"
            echo "ðŸ“ Working directory: $(pwd)"

            echo -e "\nðŸ³ Docker Status:"
            docker --version || echo "Docker not installed"
            docker ps -a || echo "Cannot list containers"

            echo -e "\nðŸ’¾ Disk Space:"
            df -h

            echo -e "\nðŸ§  Memory Usage:"
            free -h

            echo -e "\nðŸ”Œ Network Ports:"
            netstat -tulpn | grep :3000 || echo "Port 3000 not in use"

            echo -e "\nðŸ“‹ Running Processes:"
            ps aux | head -10

            echo -e "\nðŸ” Docker Images:"
            docker images | head -5

            echo -e "\nðŸ“œ Recent Docker Logs (if container exists):"
            docker logs saraha-ui --tail 20 2>/dev/null || echo "No saraha-ui container found"
